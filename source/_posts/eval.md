title: "js中的eval及with介绍"
date: 2015-06-04 17:54:08
categories: js
tags: js
---
今天在工作中遇到了eval ，弄了半天，烦死了。后来还是选择了其他的方式解决。有人建议我不要用eval，我就在想为什么？俗话说的好，哪里跌倒，哪里爬起来。于是我又更详细的了解了一下eval。介绍如下：
<!--more-->
##eval

eval 函数传递一个字符串给JavaScript `编译器`,并且执行其结果。它是一个被滥用得最多的`JavaScript特性`。那些对JavaScript语言一知半解的人们最常用到它。例如：如果你知道点表示法，但不知道下标表示法，就可能会这么写：
```
eval("myValue = myObject." + myKey + ";");
```
而不是这么写:
```
myvalue = myObject[myKey];
```

使用eval形式的代码会更加难以阅读。这种形式将使得`性能`显著降低，因为它须运行`编译器`，但也许只是为了执行一个微不足道的赋值语句。它也会让`JSLint` 失效，因此该工具`检测问题的能力`也会显著降低。

`eval` 函数还减弱了你的应用的`安全性`，因为它给被求值的文本授予了太多的`权力`。而且就像with 语句执行的方式一样，它降低了语言的`性能`。

`Function` 构造器是 eval的另一种形式，所以它同样也应该`避免使用`。

浏览器提供的 `setTimeout` 和 `setInterval `函数，它们能接受字符串参数或函数参数。当传递的是`字符串参数`时，setTimeout 和 setInterval 会像eval 那样去处理。字符串参数形式也应该被`避免使用`。
##eval 是魔鬼

`eval` 函数以及它的亲戚（`Function`、`setTimeout`、`setInterval`）提供了`访问 JavaScript 编译器`的机会。有时候这是很`有用`的，但大多数情况下它表明存在着`相当糟糕`的代码。eval 函数是 JavaScript 被`误用`得最多的特性。

##with 语句
JavaScript 提供了一个 with 语句，本意是想用来`快捷`地`访问对象的属性`。不幸的是，它的结果可能有时是`不可预料`的，所以应该`避免使用`它。
下面的语句：
```
with (obj) {
	a = b;
}
```
和下面的代码做的是同样的事情：
```
if (obj.a === undefined) {
	a = obj.b === undefined ? b : obj.b;
} else {
	obj.a = obj.b === undefined ? b : obj.b;
}
```
所以，它等于这些语句中的任何一条：
```
a = b;
a = obj.b;
obj.a = b;
obj.a = obj.b;
```
通过阅读程序代码，你`不可能辨别`出你会得到的是这些语句中的哪一条。它可能随着程序运行到下一步时发生变化。它甚至可能在程序运行过程中就发生变化了。如果你不能通过阅读程序而了解它将会做什么，你就`无法确信`它会正确地做你想要做的事情。

with 语句在该门语言中存在，`本身`就严重影响了 `JavaScript 处理器`的速度，因为它阻止了变量名的`词法作用域`绑定。它的本意是好的，但如果没有它，JavaScript语言会更好一点。

with 语句的本意是提供一个`访问深层对象成员`的捷径。糟糕的是，当设置新成员时，它的行为非常糟糕。所以`永远不要使用 with 语句`，用 `var`去代替它。

`JSLint`不期望看到 `with` 语句。